import os
import telebot
from telebot.types import Message

# === –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ===
TOKEN = os.getenv("BOT_TOKEN")
ADMIN_ID = int(os.getenv("ADMIN_ID", 220493509))  # —Ç–≤–æ–π id
bot = telebot.TeleBot(TOKEN)


# === –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ ===
@bot.message_handler(commands=['start'])
def start(message: Message):
    text = (
        "‚ú® –ü—Ä–∏–≤–µ—Ç! –ú–µ–Ω—è –∑–æ–≤—É—Ç –ï–ª–µ–Ω–∞, —è —Ç–∞—Ä–æ–ª–æ–≥ —Å 14-–ª–µ—Ç–Ω–∏–º –æ–ø—ã—Ç–æ–º.\n\n"
        "–û—á–µ–Ω—å —Ä–∞–¥–∞, —á—Ç–æ —Ç—ã –æ–±—Ä–∞—Ç–∏–ª–∞—Å—å/–ª—Å—è –∫–æ –º–Ω–µ. –Ø —Ä–∞–±–æ—Ç–∞—é —Å –¢–∞—Ä–æ –Ω–µ –∫–∞–∫ —Å "
        "¬´—Å—Ç—Ä–∞—à–Ω—ã–º–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏¬ª, –∞ –∫–∞–∫ —Å —á–µ—Å—Ç–Ω—ã–º —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–º —Å —Ç–≤–æ–∏–º –ø–æ–¥—Å–æ–∑–Ω–∞–Ω–∏–µ–º ‚Äî "
        "–∫–∞—Ä—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞–∑–≤–∏–ª–∫–∏ –∏ —Ç–æ, –Ω–∞ —á—Ç–æ –≤–∞–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ.\n\n"
        "–†–∞—Å—Å–∫–∞–∂–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —á—Ç–æ —Å–µ–π—á–∞—Å –¥–ª—è —Ç–µ–±—è —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ:\n"
        "‚Ä¢ –∫–∞–∫–∞—è —Å–∏—Ç—É–∞—Ü–∏—è –±–µ—Å–ø–æ–∫–æ–∏—Ç\n"
        "‚Ä¢ –ø—Ä–æ –∫–∞–∫–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è, –¥–µ–Ω—å–≥–∏, —Å–∞–º–æ—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é, –∑–¥–æ—Ä–æ–≤—å–µ –∏–ª–∏ –ø–µ—Ä–µ–µ–∑–¥ —Ö–æ—á–µ—à—å —Å–ø—Ä–æ—Å–∏—Ç—å\n"
        "‚Ä¢ –∫–∞–∫–∏–µ —Å—Ç—Ä–∞—Ö–∏ –∏–ª–∏ —Å–æ–º–Ω–µ–Ω–∏—è –æ—Å–æ–±–µ–Ω–Ω–æ —á—É–≤—Å—Ç–≤—É—é—Ç—å—Å—è\n\n"
        "–ü–∏—à–∏ —Å–≤–æ–±–æ–¥–Ω–æ, —Å—Ç–æ–ª—å–∫–æ, —Å–∫–æ–ª—å–∫–æ —Ç–µ–±–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ. üôè –í—Å—ë, —á—Ç–æ —Ç—ã –Ω–∞–ø–∏—à–µ—à—å, –æ—Å—Ç–∞–Ω–µ—Ç—Å—è "
        "–º–µ–∂–¥—É –Ω–∞–º–∏.\n\n"
        "–ü–æ —Ç–≤–æ–µ–º—É –∑–∞–ø—Ä–æ—Å—É —è –ø—Ä–µ–¥–ª–æ–∂—É –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–∞—Å–∫–ª–∞–¥–æ–≤ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏, "
        "—Ç—ã –≤—ã–±–µ—Ä–µ—à—å —Ç–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –±–æ–ª—å—à–µ –æ—Ç–∫–ª–∏–∫–∞–µ—Ç—Å—è ‚Äî –∏ –º—ã —Å–¥–µ–ª–∞–µ–º —Ä–∞—Å–∫–ª–∞–¥ –∏–º–µ–Ω–Ω–æ –ø–æ–¥ —Ç–µ–±—è üåô\n\n"
        "–ú–æ–∂–µ—à—å –Ω–∞—á–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å: –æ–ø–∏—à–∏ —Å–≤–æ—é —Å–∏—Ç—É–∞—Ü–∏—é –∏–ª–∏ –Ω–∞–ø–∏—à–∏, –æ —á—ë–º —Ö–æ—á–µ—Ç—Å—è —É–∑–Ω–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å."
    )

    bot.send_message(message.chat.id, text)


# === –õ—é–±—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ ===
@bot.message_handler(func=lambda m: m.from_user.id != ADMIN_ID)
def handle_client_message(message: Message):
    user_id = message.chat.id
    text = message.text

    # —Å–æ–æ–±—â–µ–Ω–∏–µ —Ç–µ–±–µ, –∫–∞–∫ –∞–¥–º–∏–Ω—É
    bot.send_message(
        ADMIN_ID,
        f"üì© –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:\n"
        f"–ò–º—è: {message.from_user.first_name}\n"
        f"–ù–∏–∫: @{message.from_user.username or '–Ω–µ—Ç –Ω–∏–∫–∞'}\n"
        f"ID: {user_id}\n\n"
        f"{text}"
    )

     # –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É
    bot.send_message(
        user_id,
        "üåô –Ø –ø–æ–ª—É—á–∏–ª–∞ —Ç–≤–æ–π –∑–∞–ø—Ä–æ—Å.\n"
        "–°–æ–≤—Å–µ–º —Å–∫–æ—Ä–æ –ø–æ—Å–º–æ—Ç—Ä—é —Å–∏—Ç—É–∞—Ü–∏—é –ø–æ –∫–∞—Ä—Ç–∞–º –∏ –ø—Ä–µ–¥–ª–æ–∂—É —Ç–µ–±–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞—Å–∫–ª–∞–¥–æ–≤. "
        "–ï—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å —á—Ç–æ-—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å –∏–ª–∏ —É—Ç–æ—á–Ω–∏—Ç—å ‚Äî –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Å—è, –ø–∏—à–∏, —á—Ç–æ —á—É–≤—Å—Ç–≤—É–µ—à—å"
    )


# === –¢–≤–æ—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É ===
@bot.message_handler(commands=['reply'])
def reply_to_user(message: Message):
    # —Ç–æ–ª—å–∫–æ —Ç—ã –º–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å /reply
    if message.chat.id != ADMIN_ID:
        bot.send_message(message.chat.id, "–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –ï–ª–µ–Ω—ã üåô")
        return

    parts = message.text.split(maxsplit=2)
    if len(parts) < 3:
        bot.send_message(
            ADMIN_ID,
            "–§–æ—Ä–º–∞—Ç –∫–æ–º–∞–Ω–¥—ã:\n/reply <user_id> <—Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞>"
        )
        return

    try:
        user_id = int(parts[1])
        reply_text = parts[2]
        bot.send_message(user_id, f"üîÆ –û—Ç–≤–µ—Ç –æ—Ç –ï–ª–µ–Ω—ã –¢–∞—Ä–æ:\n\n{reply_text}")
        bot.send_message(ADMIN_ID, "‚úÖ –û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω.")
    except Exception as e:
        bot.send_message(ADMIN_ID, f"‚ö†Ô∏è –û—à–∏–±–∫–∞: {e}")


# === –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ ===
bot.polling(timeout=60, long_polling_timeout=30)
